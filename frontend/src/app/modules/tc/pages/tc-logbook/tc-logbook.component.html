<div class="card-content table-responsive" style="height: 90vh;">
    <ng-container *ngIf="!isLoading; else spinner">

        <mat-form-field style="margin-right: 15px;">
            <mat-select placeholder="Select Class">

                <mat-option>
                    <button class="btn"
                            style="padding: 4px 7px"
                            (click)="selectAllClasses(); $event.stopPropagation();">Select All
                    </button>
                    <button class="btn"
                            style="padding: 4px 7px"
                            (click)="unselectAllClasses(); $event.stopPropagation();">Clear All
                    </button>
                </mat-option>

                <ng-container *ngFor="let classSection of classSectionList">
                    <mat-option style="width: 100%;">
                        <mat-checkbox [(ngModel)]="classSection.selected"
                                        (click)="$event.stopPropagation();">
                            {{classSection.class.name}}{{classSection.showDivision?', '+classSection.section.name:''}}
                        </mat-checkbox>
                    </mat-option>
                </ng-container>

                <mat-option>
                    <button class="btn"
                            style="padding: 4px 7px"
                            (click)="selectAllClasses(); $event.stopPropagation();">Select All
                    </button>
                    <button class="btn"
                            style="padding: 4px 7px"
                            (click)="unselectAllClasses(); $event.stopPropagation();">Clear All
                    </button>
                </mat-option>

            </mat-select>
        </mat-form-field>

        <mat-form-field style="margin-right: 15px; float: right;">
            <mat-select placeholder="Select Columns">
                <ng-container *ngFor="let col of getColumnKeys()">
                    <mat-option style="width: 100%;">
                        <mat-checkbox [(ngModel)]="columnsList[col]"
                                        (click)="$event.stopPropagation();">
                            {{col}}
                        </mat-checkbox>
                    </mat-option>
                </ng-container>
            </mat-select>
        </mat-form-field>

        <table class="table table-hover">
            <thead class="text-{{user.activeSchool.secondaryThemeColor}}">
            <tr>
                <th *ngIf="columnsList.certificateNo">Certificate No.</th>
                <th *ngIf="columnsList.scholarNo">Scholor No.</th>
                <th *ngIf="columnsList.name">Name</th>
                <th *ngIf="columnsList.classSection">Class & Section</th>
                <th *ngIf="columnsList.fathersName">Father's Name</th>
                <th *ngIf="columnsList.issueDate">Issue Date</th>
                <th *ngIf="columnsList.leavingDate">Leaving Date</th>
                <th *ngIf="columnsList.status">Satus</th>
                <th *ngIf="columnsList.generatedBy">Generated By</th>
                <th *ngIf="columnsList.issuedBy">Issued By</th>
                <th *ngIf="columnsList.cancelledBy">Cancelled By</th>
                <th *ngIf="columnsList.certificate">Certificate</th>
            </tr>
            </thead>
            <tbody>
            <tr *ngIf="getFilteredStudentSectionList().length ==0">
                <td>No TC available</td>
            </tr>
            <ng-container *ngFor="let ss of getFilteredStudentSectionList();">
                <tr>
                    <td *ngIf="columnsList.certificateNo">{{ss.tc.certificateNumber}}</td>
                    <td *ngIf="columnsList.scholarNo">{{ss.parentStudentInstance.scholarNumber}}</td>
                    <td *ngIf="columnsList.name">{{ss.parentStudentInstance.name}}</td>
                    <td *ngIf="columnsList.classSection">{{getClassSectionName(ss.parentClass, ss.parentDivision)}}</td>
                    <td *ngIf="columnsList.fathersName">{{ss.parentStudentInstance.fathersName}}</td>
                    <td *ngIf="columnsList.issueDate">{{ss.tc.issueDate}}</td>
                    <td *ngIf="columnsList.leavingDate">{{ss.tc.leavingDate}}</td>
                    <td *ngIf="columnsList.status">{{ss.tc.status}}</td>
                    <td *ngIf="columnsList.generatedBy">{{getEmployeeName(ss.tc.generatedBy)}}</td>
                    <td *ngIf="columnsList.issuedBy">{{getEmployeeName(ss.tc.issuedBy)}}</td>
                    <td *ngIf="columnsList.cancelledBy">{{getEmployeeName(ss.tc.cancelledBy)}}</td>
                    <td *ngIf="columnsList.certificate"><a [href]="ss.tc.certificateFile" target="_blank"><mat-icon>description</mat-icon></a></td>
                </tr>
            </ng-container>
            </tbody>
        </table>

    </ng-container>

    <ng-template #spinner>
        <app-loading-spinner [user]="user"></app-loading-spinner>
    </ng-template>

</div>    