<mat-card style="padding: 0; width: 100%; margin-top: 6px; overflow: hidden;">
    <div style="background-color: grey; text-align: center;">
        <i class="material-icons" style="margin-top: 4px;">backup_table</i>
    </div>
    <div style="margin: 4px; padding: 4px;">

        <div style="display: flex; flex-direction: column; margin: 6px; margin-bottom: 12px;">
            <div style="width: 100%; display: flex; flex-direction: row;"
                    *ngFor="let row of layer.rowsList; let i = index">
                <ng-container *ngFor="let column of layer.columnsList; let j = index">
                    <span style="height: 10px; width: 10px;; margin: 1px; cursor: pointer;"
                         (click)="selectedRow=row; selectedColumn = column; selectedRowNumber = i; selectedColumnNumber = j"
                         [style.backgroundColor]="selectedColumn==column&&selectedRow==row?'blue':'lightgrey'">
                    </span>
                </ng-container>
            </div>
        </div>

        <!-- <mat-form-field>
            <mat-label>
                Top Border
            </mat-label>
            
        </mat-form-field> -->

        <span>Top Grid Line</span><br>
        <div class="row" style="margin: 0px;">
            <mat-checkbox class="col-md-5" style="margin-top: 10px ; padding: 0px" [ngModel]="getBorderValue('top')"
                        (ngModelChange)="changeBorderValue('top', $event); layer.updateTableMetrix(); canvasRefresh()">Visible</mat-checkbox>          
            <mat-form-field class="col-md-7">
                <mat-label>
                    Width(mm)
                </mat-label>
                <input matInput type="number" [ngModel]="getBorderWidth('top')" (ngModelChange)="changeBorderWidth('top', $event/getPixelTommFactor()) ;layer.updateTableMetrix(); canvasRefresh(); func();"/>
            </mat-form-field>
        </div>

        <mat-form-field>
            <mat-label>
                Cell Background Color
            </mat-label>
            <input matInput type="color" [value]="layer.cells[selectedRowNumber][selectedColumnNumber].cellBackground" (input)="layer.cells[selectedRowNumber][selectedColumnNumber].cellBackground=$event.target.value; canvasRefresh(0); func();"/>
        </mat-form-field>

        <span>Bottom Grid Line</span><br>
        <div class="row" style="margin: 0px;">
            <mat-checkbox class="col-md-5" style="margin-top: 10px ; padding: 0px" [ngModel]="getBorderValue('bottom')"
                        (ngModelChange)="changeBorderValue('bottom', $event); layer.updateTableMetrix(); canvasRefresh()">Visible</mat-checkbox>              
            <mat-form-field class="col-md-7">
                <mat-label>
                    Width(mm)
                </mat-label>
                <input matInput type="number" [ngModel]="getBorderWidth('bottom')" (ngModelChange)="changeBorderWidth('bottom', $event/getPixelTommFactor()) ;layer.updateTableMetrix(); canvasRefresh(); func();"/>
            </mat-form-field>
        </div>

        <span>Left Grid Line</span><br>
        <div class="row" style="margin: 0px;">
            <mat-checkbox class="col-md-5" style="margin-top: 10px ; padding: 0px" [ngModel]="getBorderValue('left')"
                        (ngModelChange)="changeBorderValue('left', $event); layer.updateTableMetrix(); canvasRefresh()">Visible</mat-checkbox>
            <mat-form-field class="col-md-7">
                <mat-label>
                    Width(mm)
                </mat-label>
                <input matInput type="number" [ngModel]="getBorderWidth('left')" (ngModelChange)="changeBorderWidth('left', $event/getPixelTommFactor()) ;layer.updateTableMetrix(); canvasRefresh(); func();"/>
            </mat-form-field>
        </div>

        <span>Right Grid Line</span><br>
        <div class="row" style="margin: 0px;">
            <mat-checkbox class="col-md-5" style="margin-top: 10px ; padding: 0px" [ngModel]="getBorderValue('right')"
                        (ngModelChange)="changeBorderValue('right', $event); layer.updateTableMetrix(); canvasRefresh()">Visible</mat-checkbox>        
            <mat-form-field class="col-md-7">
                <mat-label>
                    Width(mm)
                </mat-label>
                <input matInput type="number" [ngModel]="getBorderWidth('right')" (ngModelChange)="changeBorderWidth('right', $event/getPixelTommFactor()) ;layer.updateTableMetrix(); canvasRefresh(); func();"/>
            </mat-form-field>
        </div>

        <mat-form-field>
            <mat-label>
                Row Height(mm)
            </mat-label>
            <input matInput type="number" [ngModel]="(selectedRow.height*getPixelTommFactor()).toFixed(2)" (ngModelChange)="selectedRow.height= $event/getPixelTommFactor() ;layer.updateTableMetrix(); canvasRefresh(); func();"/>
        </mat-form-field>

        <mat-form-field>
            <mat-label>
                Column Width(mm)
            </mat-label>
            <input matInput type="number" [ngModel]="(selectedColumn.width*getPixelTommFactor()).toFixed(2)" (ngModelChange)="selectedColumn.width = $event/getPixelTommFactor(); layer.updateTableMetrix(); canvasRefresh()"/>
        </mat-form-field>

        <!-- <mat-form-field>
            <mat-label>
                Stroke Weight(mm)
            </mat-label>
            <input matInput type="number" [ngModel]="(layer.tableStyle.lineWidth*getPixelTommFactor()).toFixed(2)" (ngModelChange)="layer.tableStyle.lineWidth = $event/getPixelTommFactor(); layer.updateTableMetrix(); canvasRefresh()"/>
        </mat-form-field>

        <mat-form-field>
            <mat-label>
                Stroke Color
            </mat-label>
            <input matInput type="color" [value]="layer.tableStyle.strokeStyle" (input)="layer.tableStyle.strokeStyle=$event.target.value; canvasRefresh(0);"/>
        </mat-form-field> -->
              
    </div>
</mat-card>
