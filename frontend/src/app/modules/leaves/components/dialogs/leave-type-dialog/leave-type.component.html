<!-- Starts :- Modal Wrapper (absolute wrapper to contain the from and display above everything) -->
<div class="modalWrapper">
    <!-- Starts :- Modal Container (Responsive container to contain the form) -->
    <div class="modalContainer" (click)="closeColorList($event)">
        <!-- Starts :- Form Title-bar -->
        <div class="modalRow titleBar">
            <div class="modalRowItem">
                <span class="modalColItem">
                    <span class="modalTitle">Leave >> Add Leave Type</span>
                </span>
            </div>
            <div class="modalRowItem">
                <div class="modalColItem">
                    <button class="material-icons closeBtn" (click)="close.emit($event)">close</button>
                </div>
            </div>
        </div>
        <!-- Ends :- Form Title-bar -->

        <!-- Starts :- Horizontal Break -->
        <div class="modalBreakLine"></div>
        <!-- Ends :- Horizontal Break -->

        <!-- Starts :- Leave Type (Form Row) -->
        <div class="modalRow">
            <div class="modalRowItem" style="width: 40%">
                <div class="modalColItem">
                    <span class="modalLabel">Select Type</span>
                </div>
            </div>
            <div class="modalRowItem" style="width: 60%">
                <div class="modalColItem">
                    <select class="modalInput" [(ngModel)]="leaveType">
                        <option value="-1">None</option>
                        <option value="0">Paid Leaves</option>
                        <option value="1">Unpaid Leaves</option>
                    </select>
                </div>
            </div>
        </div>
        <!-- Ends :- Leave Type (Form Row) -->

        <!-- Starts :- Form Row to give Leave Name -->
        <div class="modalRow">
            <!-- Starts :- Input Field to accept Leave Name -->
            <div class="modalRowItem" style="width: 40%">
                <div class="modalColItem">
                    <span class="modalLabel">Set Denotation</span>
                </div>
            </div>
            <div class="modalRowItem" style="width: 60%">
                <div class="modalColItem">
                    <input class="modalInput" [(ngModel)]="name" [value]="name" placeholder="eg. CL" />
                </div>
            </div>
            <!-- Ends :- Input Field -->
        </div>
        <!-- Ends :- Form Row to give Leave Name -->

        <div class="modalRow">
            <!-- Starts :- Custom Input Selector to accept color code for this leave type -->
            <div class="modalRowItem" style="width: 40%">
                <div class="modalColItem">
                    <span class="modalLabel">Set Colour</span>
                </div>
            </div>
            <div class="modalRowItem" style="width: 60%">
                <div class="modalColItem">
                    <!-- Starts :- Button to activate drop-down -->
                    <span class="colorSelector" (click)="isColorListVisible = !isColorListVisible">
                        <span
                            id="colorIndicator"
                            class="colorSelector modalInput"
                            [ngStyle]="{ backgroundColor: color === '' ? '#ffffff' : color }"
                            style="cursor: pointer; width: 100%; display: flex; flex-direction: row; justify-content: space-between"
                        >
                            <div class="colorSelector">
                                {{ color == "" ? "Select Color" : "Change Color" }}
                            </div>
                            <div class="colorSelector material-icons">arrow_drop_down</div>
                        </span>
                    </span>
                    <!-- Ends :- Button to activate drop-down -->

                    <!-- Starts :- Drop-down color selector -->
                    <div *ngIf="isColorListVisible" class="modalOptionsContainer">
                        <div
                            *ngFor="let colorCode of colorCodeList"
                            (click)="updateColor($event, colorCode)"
                            [ngStyle]="{ background: colorCode, border: color === colorCode ? '1px solid black' : 'none' }"
                            style="width: 10%; height: 25px; margin-top: 2.5px; margin-bottom: 2.5px; border-radius: 2px; cursor: pointer"
                        ></div>
                    </div>
                    <!-- Ends :- Drop-down color selector -->
                </div>
            </div>
            <!-- Ends :- Custom Input Selector -->

            <!-- Starts :- CarryForward and Encashments -->
            <div class="modalRow">
                <div class="modalRowItem" style="width: 100%">
                    <div class="modalColItem">
                        <span class="modalTitle">Carry-Forwarding and Encashments -</span>
                    </div>
                </div>
            </div>
            <div class="modalRow">
                <div class="modalRowItem" style="width: 5ch; padding-left: 5px; padding-right: 5px">
                    <div class="modalColItem" style="text-align: center"></div>
                </div>
                <div class="modalRowItem" style="width: 100px; padding-left: 5px; padding-right: 5px">
                    <div class="modalColItem" style="text-align: left">Value</div>
                </div>
                <div class="modalRowItem" style="width: fit-content; padding-left: 5px; padding-right: 5px">
                    <div class="modalColItem" style="text-align: left">Remaining Leaves</div>
                </div>
            </div>
            <div class="modalRow" *ngFor="let month of months">
                <div class="modalRowItem" style="width: 5ch; padding-left: 5px; padding-right: 5px">
                    <div class="modalColItem" style="text-align: center; text-transform: capitalize">
                        {{ month }}
                    </div>
                </div>
                <div class="modalRowItem" style="width: 100px; padding-left: 5px; padding-right: 5px">
                    <div class="modalColItem" style="text-align: left">
                        <input class="modalInput" (keyup)="checkInput($event)" type="number" min="0" [(ngModel)]="leavesPerMonth[month][0]" />
                    </div>
                </div>
                <div class="modalRowItem" style="max-width: 250px; flex-grow: 1; padding-left: 5px; padding-right: 5px">
                    <div class="modalColItem" style="text-align: left">
                        <select (change)="updateLeaves($event, month)" class="modalInput">
                            <option value="0" [selected]="leavesPerMonth[month][1] == 0">CFW (Carry-forward)</option>
                            <option value="1" [selected]="leavesPerMonth[month][1] == 1">Lapse</option>
                            <option value="2" [selected]="leavesPerMonth[month][1] == 2">ENC (Encashed)</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="modalRow">
                <div class="modalRowItem" style="width: 100%">
                    <div class="modalColItem">
                        <div
                            (click)="isNoteVisible = !isNoteVisible"
                            class="modalNote"
                            [ngStyle]="{
                                cursor: 'pointer',
                                display: !isNoteVisible ? 'inline-block' : 'block',
                                whiteSpace: !isNoteVisible ? 'nowrap' : 'normal'
                            }"
                        >
                            Note - Policies are applicable for the next month. CFW for January will decide if leaves will be carry-forwarded from January to
                            February
                        </div>
                    </div>
                </div>
            </div>
            <!-- Ends :- CarryForward and Encashments -->

            <!-- Starts :- Horizontal Break -->
            <div class="modalBreakLine"></div>
            <!-- Ends :- Horizontal Break -->

            <!-- Starts :- Set Encashments Formula -->
            <div class="modalRow" *ngIf="isEncFormulaVisible">
                <div class="modalRowItem" style="width: 100%">
                    <div class="modalColItem">
                        <span class="modalTitle" style="text-overflow: ellipsis; overflow: hidden; display: inline-block; white-space: nowrap"
                            >Set Encashments Formula -
                        </span>
                    </div>
                </div>
            </div>

            <div class="modalRow" *ngIf="isEncFormulaVisible">
                <div class="modalRowItem" style="flex-grow: 1">
                    <div class="modalColItem">
                        <input class="modalInput" type="text" [(ngModel)]="componentName" placeholder="Encashment Component Name..." />
                    </div>
                </div>
                <div class="modalRowItem">
                    <div class="modalColItem">
                        <button (click)="addComponent($event)" mat-stroked-button style="height: 100%; text-align: center" class="material-icons">add</button>
                    </div>
                </div>
            </div>

            <div class="modalRow" *ngIf="activeComponentCount === 0 && isEncFormulaVisible">
                <div class="modalRowItem" style="width: 100%">
                    <div class="modalColItem">
                        <span class="modalNote">Add component to start generating the formula</span>
                    </div>
                </div>
            </div>
            <div class="modalRow" *ngIf="activeComponentCount !== 0 && isEncFormulaVisible">
                <div class="modalRowItem" style="width: fit-content" *ngFor="let component of encashmentComponentList">
                    <div class="modalColItem">
                        <button (click)="removeComponent($event, component)" mat-stroked-button style="height: 100%; text-align: center">
                            <span style="padding: 3px">{{ component }}</span>
                            <span class="material-icons">remove</span>
                        </button>
                    </div>
                </div>
            </div>
            <div class="modalRow" *ngIf="activeComponentCount !== 0 && isEncFormulaVisible">
                <div class="modalRowItem" style="width: 100%">
                    <div class="modalColItem">
                        <div
                            style="height: 100%; display: flex; flex-direction: column; justify-content: center; padding: 10px"
                            [ngStyle]="{ borderBottom: !isEncFormulaValid ? '1px solid rgba(255, 0, 0, 0.5)' : '1px solid rgba(0, 255, 110, 0.5)' }"
                        >
                            {{ encashmentFormula === "" ? "Encashment formula will be generated here..." : encashmentFormula }}
                        </div>
                    </div>
                </div>
            </div>
            <div class="modalRow" *ngIf="activeComponentCount !== 0 && isEncFormulaVisible">
                <div class="modalRowItem" style="width: fit-content">
                    <div class="modalColItem">
                        <button (click)="updateEncashmentFormula($event, '+')" mat-stroked-button style="height: 100%; text-align: center">
                            <span class="material-icons">add</span>
                        </button>
                    </div>
                </div>
                <div class="modalRowItem" style="width: fit-content">
                    <div class="modalColItem">
                        <button (click)="updateEncashmentFormula($event, '-')" mat-stroked-button style="height: 100%; text-align: center">
                            <span class="material-icons">remove</span>
                        </button>
                    </div>
                </div>
                <div class="modalRowItem" style="width: fit-content">
                    <div class="modalColItem">
                        <button (click)="updateEncashmentFormula($event, '*')" mat-stroked-button style="height: 100%; text-align: center">
                            <span class="material-icons">close</span>
                        </button>
                    </div>
                </div>
                <div class="modalRowItem" style="width: fit-content">
                    <div class="modalColItem">
                        <button (click)="updateEncashmentFormula($event, '/')" mat-stroked-button style="height: 100%; text-align: center">
                            <span class="modelColItem" style="padding: 0px; font-size: x-large; font-weight: 500">/</span>
                        </button>
                    </div>
                </div>
                <div class="modalRowItem" style="width: fit-content">
                    <div class="modalColItem">
                        <button (click)="updateEncashmentFormula($event, '(')" mat-stroked-button style="height: 100%; text-align: center">
                            <span class="modelColItem" style="padding: 0px; font-size: x-large; font-weight: 500">(</span>
                        </button>
                    </div>
                </div>
                <div class="modalRowItem" style="width: fit-content">
                    <div class="modalColItem">
                        <button (click)="updateEncashmentFormula($event, ')')" mat-stroked-button style="height: 100%; text-align: center">
                            <span class="modelColItem" style="padding: 0px; font-size: x-large; font-weight: 500">)</span>
                        </button>
                    </div>
                </div>
                <div class="modalRowItem" style="width: fit-content">
                    <div class="modalColItem">
                        <button (click)="updateEncashmentFormula($event, -1)" mat-stroked-button style="height: 100%; text-align: center">
                            <span class="material-icons">backspace</span>
                        </button>
                    </div>
                </div>
                <div class="modalRowItem" style="width: fit-content" *ngFor="let component of encashmentComponentList">
                    <div class="modalColItem">
                        <button (click)="updateEncashmentFormula($event, component)" mat-stroked-button style="height: 100%; text-align: center">
                            <span>{{ component }}</span>
                        </button>
                    </div>
                </div>
            </div>
            <!-- Ends :- Set Encashments Formula -->

            <!-- Starts :- Horizontal Break -->
            <div class="modalBreakLine" *ngIf="isEncFormulaVisible"></div>
            <!-- Ends :- Horizontal Break -->

            <!-- Starts :- Buttons to Close / Save the form -->
            <div class="modalRow" style="padding: 5px 5px 5px 20px; margin-top: 12px; margin-bottom: 12px; justify-content: end">
                <button (click)="saveData($event)" class="modalButton" style="color: white; background: #fe9800" [disabled]="isSaving">
                    {{ isNew ? "Add" : "Update" }}
                </button>
                <button class="modalButton" (click)="close.emit($event)" style="border: 1px solid #fe9800" [disabled]="isSaving">Cancel</button>
            </div>
            <!-- Ends :- Buttons to Close / Save the form -->
        </div>
    </div>
    <!-- Ends :- Modal Container (Responsive container to contain the form) -->
</div>
<!-- Ends :- Modal Wrapper (absolute wrapper to contain the from and display above everything) -->
