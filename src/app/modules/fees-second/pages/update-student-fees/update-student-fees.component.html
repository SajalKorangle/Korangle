<div class="card-content">

    <!-- app-student-filter [user]="user" (onStudentListSelected)="getStudentFeeDetails($event)"></app-student-filter -->
    <student-filter [user]="user" (onStudentSelected)="getStudentFeeDetails($event)"></student-filter>

    <ng-container *ngIf="studentFeeStatus && !isLoading">

        <table class="table table-hover" style="font-weight: 800 !important;">
            <thead class="text-{{user.activeSchool.secondaryThemeColor}}">
            <tr>
                <th colspan='2'>Fee Type</th>
                <th class="text-right">Paid & Exempted</th>
                <th class="text-right">SchoolFee</th>
                <th class="text-right">Student Fee Initial Value</th>
                <th class="text-right" style="padding-right: 25px;">Student Fee Final Value</th>
            </tr>
            </thead>
            <tbody>
            <ng-container *ngFor="let component of studentFeeStatus.componentList">
                <tr [class.backgroundHighlight]="getComponentTotalFeeInitialValue(component)-getComponentTotalFeeFinalValue(component)">
                    <td colspan='2'>{{component.feeType}}</td>
                    <td class="text-right">{{getComponentTotalFeeInitialValue(component)-getComponentFeesDue(component)}}</td>
                    <td class="text-right">{{getComponentSchoolTotalFee(component)}}</td>
                    <td class="text-right">{{getComponentTotalFeeInitialValue(component)}}</td>
                    <td class="text-right" *ngIf="component.frequency==frequencyList[0]">
                        <input class='paymentInput'
                               type="number"
                               [attr.min]="getComponentTotalFeeInitialValue(component)-getComponentFeesDue(component)"
                               [(ngModel)]="component.amount"
                               (blur)="policeComponentTotalFeeInput(component, $event)">
                    </td>
                    <td class="text-right" style="padding-right: 25px;" *ngIf="component.frequency==frequencyList[1]">
                        {{getComponentTotalFeeFinalValue(component)}}
                    </td>
                </tr>
                <ng-container *ngIf="component.frequency==this.frequencyList[1]">
                    <ng-container *ngFor="let monthlyComponent of component.monthList">
                        <tr [class.backgroundHighlight]="getComponentMonthlyTotalFeeInitialValue(monthlyComponent)-monthlyComponent.amount">
                            <td class="text-right"></td>
                            <td class="text-right">{{monthlyComponent.month}}</td>
                            <td class="text-right">{{getComponentMonthlyTotalFeeInitialValue(monthlyComponent)-getComponentMonthlyFeesDue(monthlyComponent)}}</td>
                            <td class="text-right">{{getComponentMonthlySchoolTotalFee(monthlyComponent)}}</td>
                            <td class="text-right">{{getComponentMonthlyTotalFeeInitialValue(monthlyComponent)}}</td>
                            <td class="text-right">
                                <input class='paymentInput'
                                       type="number"
                                       [attr.min]="getComponentMonthlyTotalFeeInitialValue(monthlyComponent)-getComponentMonthlyFeesDue(monthlyComponent)"
                                       [(ngModel)]="monthlyComponent.amount"
                                       (blur)="policeComponentMonthlyTotalFeeInput(monthlyComponent, $event)">
                            </td>
                        </tr>
                    </ng-container>
                </ng-container>
            </ng-container>
            </tbody>
        </table>

        <button class="btn btn-{{user.activeSchool.secondaryThemeColor}}"
                *ngIf="getStudentTotalFeeInitialValue()!=getStudentTotalFeeFinalValue()"
                (click)="updateStudentFees()">
            Update
        </button>

    </ng-container>

    <ng-container *ngIf="isLoading">
        <app-loading-spinner [user]="user"></app-loading-spinner>
    </ng-container>

</div>
