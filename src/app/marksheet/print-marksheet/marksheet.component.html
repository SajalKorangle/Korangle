<div class="main-content">
    <div class="container-fluid">

        <div class="card" style="min-height: 100%">
            <div class="card-header" [attr.data-background-color]="user.color">
                <h4 class="title">Student Marksheet</h4>
            </div>
            <div class="card-content">

                <button type="button"
                        *ngIf="marksheet !== undefined && !isLoading && marksheet.result.length > 0"
                        class="btn btn-{{user.btn_color}}"
                        style="padding: 12px 15px; margin-right: 17px; float: right"
                        matTooltip="Print the following marksheet"
                        tooltip-position="left"
                        (click)="printMarksheet();">
                    Print<i class="material-icons" style="margin-left: 15px;">print</i></button>

                <form class="example-form" *ngIf="!isListLoading">
                    <mat-form-field class="example-full-width">
                        <input type="text"
                               placeholder="Type student name here...."
                               aria-label="Student"
                               matInput
                               [formControl]="myControl"
                               [matAutocomplete]="auto">
                        <mat-autocomplete #auto="matAutocomplete"
                                          (optionSelected)="getStudentMarksheet($event.option.value)"
                                          [displayWith]="displayFn">
                            <mat-option *ngFor="let student of filteredStudentList | async" [value]="student">
                                {{ student.name }}, {{ student.className }}
                                <span *ngIf="student.showSectionName">, {{student.sectionName}}</span>
                            </mat-option>
                        </mat-autocomplete>
                    </mat-form-field>
                </form>

                <div class="clearfix"></div>

                <ng-container *ngIf="marksheet !== undefined && !isLoading && marksheet.result.length > 0">

                    <!-- Roll No. , Scholar No. -->
                    <div class="row no-gutters">
                        <div class="col-xs-3 d-flex justify-content-start custom-padding"
                             style="font-size: 14px;">
                            Roll No.<span style="float: right">:</span>
                        </div>
                        <div class="col-xs-5 d-flex justify-content-start custom-padding"
                             style="font-size: 14px;">
                            <i>{{marksheet.studentProfile.rollNumber}}</i>
                        </div>
                        <div class="col-xs-2 d-flex justify-content-start custom-padding"
                             style="font-size: 14px;">
                            Scholar No.<span style="float: right">:</span>
                        </div>
                        <div class="col-xs-2 d-flex justify-content-start custom-padding"
                             style="font-size: 14px;">
                            <i>{{marksheet.studentProfile.scholarNumber}}</i>
                        </div>
                    </div>

                    <!-- Student's Name , Aadhar No. -->
                    <div class="row no-gutters">
                        <div class="col-xs-3 d-flex justify-content-start custom-padding"
                             style="font-size: 14px;">
                            Student's Name<span style="float: right">:</span>
                        </div>
                        <div class="col-xs-5 d-flex justify-content-start custom-padding"
                             style="font-size: 14px;">
                            <i>{{marksheet.studentProfile.name}}</i>
                        </div>
                        <div class="col-xs-2 d-flex justify-content-start custom-padding"
                             style="font-size: 14px;">
                            Aadhar No.<span style="float: right">:</span>
                        </div>
                        <div class="col-xs-2 d-flex justify-content-start custom-padding"
                             style="font-size: 14px;">
                            <i>{{marksheet.studentProfile.aadharNumber}}</i>
                        </div>
                    </div>

                    <!-- Father's Name , Category -->
                    <div class="row no-gutters">
                        <div class="col-xs-3 d-flex justify-content-start custom-padding"
                             style="font-size: 14px;">
                            Father's Name<span style="float: right">:</span>
                        </div>
                        <div class="col-xs-5 d-flex justify-content-start custom-padding"
                             style="font-size: 14px;">
                            <i>{{marksheet.studentProfile.fathersName}}</i>
                        </div>
                        <div class="col-xs-2 d-flex justify-content-start custom-padding"
                             style="font-size: 14px;">
                            Category<span style="float: right">:</span>
                        </div>
                        <div class="col-xs-2 d-flex justify-content-start custom-padding"
                             style="font-size: 14px;">
                            <i>{{marksheet.studentProfile.category}}</i>
                        </div>
                    </div>

                    <!-- Mother's Name , SSMID -->
                    <div class="row no-gutters">
                        <div class="col-xs-3 d-flex justify-content-start custom-padding"
                             style="font-size: 14px;">
                            Mother's Name<span style="float: right">:</span>
                        </div>
                        <div class="col-xs-5 d-flex justify-content-start custom-padding"
                             style="font-size: 14px;">
                            <i>{{marksheet.studentProfile.motherName}}</i>
                        </div>
                        <div class="col-xs-2 d-flex justify-content-start custom-padding"
                             style="font-size: 14px;">
                            SSMID<span style="float: right">:</span>
                        </div>
                        <div class="col-xs-2 d-flex justify-content-start custom-padding"
                             style="font-size: 14px;">
                            <i>{{marksheet.studentProfile.childSSMID}}</i>
                        </div>
                    </div>

                    <!-- Date of Birth , Contact No. -->
                    <div class="row no-gutters">
                        <div class="col-xs-3 d-flex justify-content-start custom-padding"
                             style="font-size: 14px;">
                            Date of birth<span style="float: right">:</span>
                        </div>
                        <div class="col-xs-5 d-flex justify-content-start custom-padding"
                             style="font-size: 14px;">
                            <i>{{marksheet.studentProfile.dateOfBirth | date: 'dd/MM/yyyy' }}</i>
                        </div>
                        <div  *ngIf="user.schoolName == 'EKLAVYA'"
                              class="col-xs-2 d-flex justify-content-start custom-padding"
                             style="font-size: 14px;">
                            Contact No.<span style="float: right">:</span>
                        </div>
                        <div  *ngIf="user.schoolName == 'EKLAVYA'"
                              class="col-xs-2 d-flex justify-content-start custom-padding"
                             style="font-size: 14px;">
                            <i>{{marksheet.studentProfile.mobileNumber}}</i>
                        </div>
                    </div>

                    <!-- Address -->
                    <div  *ngIf="user.schoolName == 'EKLAVYA'"
                          class="row no-gutters">
                        <div class="col-xs-3 d-flex custom-padding"
                             style="font-size: 14px;">
                            Address<span style="float: right">:</span>
                        </div>
                        <div class="col-xs-9 d-flex custom-padding"
                             style="font-size: 14px;">
                            <i>{{marksheet.studentProfile.address}}</i>
                        </div>
                    </div>

                    <!-- Marksheet Heading -->
                    <div class="row no-gutters" style="margin-top: 10px; margin-bottom: 10px;">
                        <div class="col-xs-12" align="center">
                            <span style="font-size: 20px;">External / Internal Valuation</span>
                        </div>
                    </div>

                    <!-- Marksheet -->
                    <div class="row no-gutters">
                        <div class="col-xs-12">
                            <table class="table updownBorder" style="font-size: 16px !important;">
                                <tbody>
                                <tr>
                                    <td class="upBorder leftBorder" style="padding: 5px" align="left"><b>Subject</b></td>
                                    <td class="upBorder" align="right"><b>Max. Marks</b></td>
                                    <td class="upBorder" align="right"><b>Marks Obt.</b></td>
                                    <td class="upBorder rightBorder" align="center"><b>Grade</b></td>
                                </tr>
                                <ng-container *ngFor="let result of marksheet.result; let i = index;">
                                    <tr *ngIf="result.governmentSubject">
                                        <td class="leftBorder" style="padding: 5px;">{{result.subjectName}}</td>
                                        <td style="padding: 5px; padding-right: 30px;" align="right">{{result.maximumMarks}}</td>
                                        <td style="padding: 5px; padding-right: 30px;" align="right">{{result.marksObtained | number: '1.0-2'}}</td>
                                        <td class="rightBorder" style="padding: 5px;" align="center">{{result.grade}}</td>
                                    </tr>
                                </ng-container>
                                <tr>
                                    <td class="updownBorder leftBorder" style="padding: 5px;">Total</td>
                                    <td class="updownBorder" style="padding: 5px; padding-right: 30px;" align="right">{{getTotalMaximumMarks(marksheet)}}</td>
                                    <td class="updownBorder" style="padding: 5px; padding-right: 30px;" align="right">{{getTotalMarksObtained(marksheet)}}</td>
                                    <td class="updownBorder rightBorder" style="padding: 5px;" align="center">{{marksheet.overAllGrade}}</td>
                                </tr>
                                <tr>
                                    <td class="downBorder" colspan="4" style="padding: 5px;">Total Marks In Words: {{ getTotalMarksObtained(marksheet) | amountInWords }}</td>
                                </tr>
                                <ng-container *ngFor="let result of marksheet.result; let i = index;">
                                    <tr *ngIf="!result.governmentSubject">
                                        <td class="leftBorder" style="padding: 5px;">{{result.subjectName}}</td>
                                        <td style="padding: 5px; padding-right: 30px;" align="right">{{result.maximumMarks}}</td>
                                        <td style="padding: 5px; padding-right: 30px;" align="right">{{result.marksObtained | number: '1.0-2'}}</td>
                                        <td class="rightBorder" style="padding: 5px;" align="center">{{result.grade}}</td>
                                    </tr>
                                </ng-container>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Percentage, Grade, Attendance -->
                    <div class="row no-gutters" style="font-size: 16px !important;">
                        <div class="col-xs-3 custom-padding">
                            Perc. - {{getPercentage(marksheet) | number: '1.0-2'}}%
                        </div>
                        <div class="col-xs-2 d-flex custom-padding">
                            Grade - {{marksheet.overAllGrade}}
                        </div>
                        <div class="col-xs-7 d-flex custom-padding" align="end">
                            Attendance - {{marksheet.attendance}}/{{marksheet.workingDays}}
                        </div>
                    </div>
                    <div class="row no-gutters" style="font-size: 16px !important;">
                        <div class="col-xs-12 custom-padding">
                            Promoted To - <input type="text" [(ngModel)]="nextClassName">
                        </div>
                    </div>

                </ng-container>

                <ng-container *ngIf="marksheet !== undefined && !isLoading && marksheet.result.length == 0">
                    **No marksheet available for selected student
                </ng-container>

            </div>
        </div>

        <ng-container *ngIf="isLoading || isListLoading">
            <app-loading-spinner [user]="user"></app-loading-spinner>
        </ng-container>

    </div>
</div>
