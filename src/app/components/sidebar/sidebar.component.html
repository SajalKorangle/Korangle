<div class="logo">
    <span style="margin-left: 10px;">Hi {{user.displayName}}!</span>
    <a style="float: right; cursor: pointer;"
       *ngIf="!user.section"
       (click)="logout()">Logout</a>
    <br/>
    <a class="simple-text" disabled="true" *ngIf="user.schoolList.length > 0">
        <div class="logo-img" *ngIf="user.activeSchool">
            <img src="{{user.activeSchool.logo}}" style="border-radius: 2px;"/>
        </div>

        <!-- Multiple School List -->
        <ng-container *ngIf="user.schoolList.length>1">
            <select [(ngModel)]="user.activeSchool"
                    (ngModelChange)="handleSchoolChange()"
                    style="padding: 0px; border: none; background-color: transparent;">
                <option *ngFor="let school of user.schoolList;"
                        [ngValue]="school">
                    {{school.name}}
                </option>
            </select>
        </ng-container>

        <!-- Single School -->
        <ng-container *ngIf="user.schoolList.length===1">
            {{user.activeSchool.name}}
        </ng-container>

        <!-- Role -->
        <ng-container *ngIf="user.activeSchool">
            <ng-container *ngIf="user.activeSchool.studentList.length > 0 && user.activeSchool.moduleList.length > 0">

                <br/>

                <select [(ngModel)]="user.activeSchool.role"
                        (ngModelChange)="handleRoleChange()"
                        [class.sessionMargin60]="user.schoolList.length>1"
                        [class.sessionMargin52]="user.schoolList.length==1"
                        style="padding: 0px; border: none; background-color: transparent;">
                    <option value="Employee">Employee</option>
                    <option value="Parent">Parent</option>
                </select>

            </ng-container>
        </ng-container>

        <br/>

        <!-- Current Session Name -->
        <span [class.sessionMargin68]="user.schoolList.length>1"
              [class.sessionMargin60]="user.schoolList.length==1">
            <span *ngIf="user.activeSchool.currentSessionDbId==1">2017-18</span>
            <span *ngIf="user.activeSchool.currentSessionDbId==2">2018-19</span>
        </span>

    </a>
</div>

<div class="sidebar-wrapper">

    <div class="nav-container">

        <ul class="nav" *ngIf="user.activeSchool">

            <!-- Parent -->
            <ng-container *ngIf="user.activeSchool.role==='Parent'">

                <!-- Multiple Students -->
                <ng-container *ngIf="user.activeSchool.studentList.length > 1">
                    <ng-container  *ngFor="let student of user.activeSchool.studentList">
                        <li [class.active]="student.name === user.section.title"
                            [attr.data-color]='user.activeSchool.primaryThemeColor'
                            style="border-bottom: 0.1px solid lightgrey;">
                            <a (click)="student.showTaskList = !student.showTaskList;">
                                <i class="material-icons">account_circle</i>
                                <p>
                                    {{student.name}}
                                    <i *ngIf="!student.showTaskList" class="material-icons" style="float: right;">keyboard_arrow_down</i>
                                    <i *ngIf="student.showTaskList" class="material-icons" style="float: right;">keyboard_arrow_up</i>
                                </p>
                            </a>
                            <ng-container *ngIf="student.showTaskList">
                                <div *ngFor="let task of student.taskList"
                                     [attr.data-color]="user.activeSchool.secondaryThemeColor"
                                     [class.active]="student.name===user.section.title && task.title===user.section.subTitle"
                                     class="subsectionDiv"
                                     (click)="changePage(task, student);">
                                    <i class="material-icons">remove</i>
                                    <p>{{task.title}}</p>
                                </div>
                            </ng-container>
                        </li>
                    </ng-container>
                </ng-container>

                <!-- Single Student -->
                <ng-container *ngIf="user.activeSchool.studentList.length === 1">
                    <ng-container  *ngFor="let task of user.activeSchool.studentList[0].taskList">
                        <li [class.active]="user.activeSchool.studentList[0].name === user.section.route"
                            [attr.data-color]='user.activeSchool.primaryThemeColor'
                            style="border-bottom: 0.1px solid lightgrey;">
                            <a (click)="changePage(task, user.activeSchool.studentList[0]);">
                                <i class="material-icons">{{task.icon}}</i>
                                <p>
                                    {{task.title}}
                                </p>
                            </a>
                        </li>
                    </ng-container>
                </ng-container>

            </ng-container>

            <!-- Employee -->
            <ng-container *ngIf="user.section && user.activeSchool.role==='Employee'">
                <ng-container *ngFor="let module of user.activeSchool.moduleList">
                    <li [class.active]="module.path === user.section.route"
                        [attr.data-color]='user.activeSchool.primaryThemeColor'
                        style="border-bottom: 0.1px solid lightgrey;">
                        <a (click)="module.showTaskList = !module.showTaskList;">
                            <i class="material-icons">{{module.icon}}</i>
                            <p>
                                {{module.title}}
                                <i *ngIf="!module.showTaskList" class="material-icons" style="float: right;">keyboard_arrow_down</i>
                                <i *ngIf="module.showTaskList" class="material-icons" style="float: right;">keyboard_arrow_up</i>
                            </p>
                        </a>
                        <ng-container *ngIf="module.showTaskList">
                            <div *ngFor="let task of module.taskList"
                                 [attr.data-color]="user.activeSchool.secondaryThemeColor"
                                 [class.active]="module.path===user.section.route && task.title===user.section.subTitle"
                                 class="subsectionDiv"
                                 (click)="changePage(task, module);">
                                <i class="material-icons">remove</i>
                                <p>{{task.title}}</p>
                            </div>
                        </ng-container>
                    </li>
                </ng-container>
            </ng-container>

            <li style="margin-bottom: 80px;">
                <a (click)="logout()">
                    <i class="material-icons">exit_to_app</i>
                    <p>Log out</p>
                </a>
            </li>

        </ul>

    </div>

</div>