<div class="main-content">
  <div class="container-fluid">

    <div class="card">
      <div class="card-header" [attr.data-background-color]="user.color">
        <h4 class="title">Student List</h4>
        <p class="category">Get filtered list of student</p>
      </div>
      <div class="card-content table-responsive">

        <!-- Class Filter -->
        <mat-form-field style="margin-right: 15px;">
          <mat-select placeholder="Select Class" style="width: 100%;">
            <mat-option>
              <button class="btn"
                      style="padding: 4px 7px"
                      (click)="selectAllClasses(); $event.stopPropagation();">Select All
              </button>
              <button class="btn"
                      style="padding: 4px 7px"
                      (click)="unselectAllClasses(); $event.stopPropagation();">Clear All
              </button>
            </mat-option>
            <ng-container *ngFor="let class of classSectionStudentList">
              <mat-option *ngFor="let section of class.sectionList" style="width: 100%;">
                <mat-checkbox [(ngModel)]="section.selected"
                              (ngModelChange)="handleStudentDisplay()"
                              (click)="$event.stopPropagation();">
                  {{class.name}}<span *ngIf="class.sectionList.length > 1">, {{section.name}}</span>
                </mat-checkbox>
              </mat-option>
            </ng-container>
            <mat-option>
              <button class="btn"
                      style="padding: 4px 7px"
                      (click)="selectAllClasses(); $event.stopPropagation();">Select All
              </button>
              <button class="btn"
                      style="padding: 4px 7px"
                      (click)="unselectAllClasses(); $event.stopPropagation();">Clear All
              </button>
            </mat-option>
          </mat-select>
        </mat-form-field>

        <!-- Column Filter -->
        <mat-form-field style="margin-right: 15px;">
          <mat-select placeholder="Select Columns">
            <mat-option>
              <button class="btn"
                      style="padding: 4px 7px"
                      (click)="selectAllColumns(); $event.stopPropagation();">Select All
              </button>
              <button class="btn"
                      style="padding: 4px 7px"
                      (click)="unSelectAllColumns(); $event.stopPropagation();">Clear All
              </button>
            </mat-option>
            <mat-option>
              <mat-checkbox [(ngModel)]="columnFilter.showSerialNumber" (click)="$event.stopPropagation();">Serial No.
              </mat-checkbox>
            </mat-option>
            <mat-option>
              <mat-checkbox [(ngModel)]="columnFilter.showName" (click)="$event.stopPropagation();">Name</mat-checkbox>
            </mat-option>
            <mat-option>
              <mat-checkbox [(ngModel)]="columnFilter.showClassName" (click)="$event.stopPropagation();">Class Name
              </mat-checkbox>
            </mat-option>
            <mat-option>
              <mat-checkbox [(ngModel)]="columnFilter.showRollNumber" (click)="$event.stopPropagation();">Roll No.
              </mat-checkbox>
            </mat-option>
            <mat-option>
              <mat-checkbox [(ngModel)]="columnFilter.showFathersName" (click)="$event.stopPropagation();">Father's
                Name
              </mat-checkbox>
            </mat-option>
            <mat-option>
              <mat-checkbox [(ngModel)]="columnFilter.showMobileNumber" (click)="$event.stopPropagation();">Mobile No.
              </mat-checkbox>
            </mat-option>
            <mat-option>
              <mat-checkbox [(ngModel)]="columnFilter.showScholarNumber" (click)="$event.stopPropagation();">Scholar
                No.
              </mat-checkbox>
            </mat-option>
            <mat-option>
              <mat-checkbox [(ngModel)]="columnFilter.showDateOfBirth" (click)="$event.stopPropagation();">Date of
                Birth
              </mat-checkbox>
            </mat-option>
            <!--mat-option>
              <mat-checkbox [(ngModel)]="columnFilter.showTotalFees" (click)="$event.stopPropagation();">Total Fees
              </mat-checkbox>
            </mat-option>
            <mat-option>
              <mat-checkbox [(ngModel)]="columnFilter.showFeesDue" (click)="$event.stopPropagation();">Fees Due
              </mat-checkbox>
            </mat-option -->
            <mat-option>
              <mat-checkbox [(ngModel)]="columnFilter.showMotherName" (click)="$event.stopPropagation();">Mother's
                Name
              </mat-checkbox>
            </mat-option>
            <mat-option>
              <mat-checkbox [(ngModel)]="columnFilter.showGender" (click)="$event.stopPropagation();">Gender
              </mat-checkbox>
            </mat-option>
            <mat-option>
              <mat-checkbox [(ngModel)]="columnFilter.showCaste" (click)="$event.stopPropagation();">Caste
              </mat-checkbox>
            </mat-option>
            <mat-option>
              <mat-checkbox [(ngModel)]="columnFilter.showCategory" (click)="$event.stopPropagation();">Category
              </mat-checkbox>
            </mat-option>
            <mat-option>
              <mat-checkbox [(ngModel)]="columnFilter.showReligion" (click)="$event.stopPropagation();">Religion
              </mat-checkbox>
            </mat-option>
            <mat-option>
              <mat-checkbox [(ngModel)]="columnFilter.showFatherOccupation" (click)="$event.stopPropagation();">Father's
                Occupation
              </mat-checkbox>
            </mat-option>
            <mat-option>
              <mat-checkbox [(ngModel)]="columnFilter.showAddress" (click)="$event.stopPropagation();">Address
              </mat-checkbox>
            </mat-option>
            <mat-option>
              <mat-checkbox [(ngModel)]="columnFilter.showChildSSMID" (click)="$event.stopPropagation();">Child SSMID
              </mat-checkbox>
            </mat-option>
            <mat-option>
              <mat-checkbox [(ngModel)]="columnFilter.showFamilySSMID" (click)="$event.stopPropagation();">Family
                SSMID
              </mat-checkbox>
            </mat-option>
            <mat-option>
              <mat-checkbox [(ngModel)]="columnFilter.showBankName" (click)="$event.stopPropagation();">Bank Name
              </mat-checkbox>
            </mat-option>
            <mat-option>
              <mat-checkbox [(ngModel)]="columnFilter.showBankAccountNum" (click)="$event.stopPropagation();">Bank Acc.
                No.
              </mat-checkbox>
            </mat-option>
            <mat-option>
              <mat-checkbox [(ngModel)]="columnFilter.showAadharNum" (click)="$event.stopPropagation();">Aadhar No.
              </mat-checkbox>
            </mat-option>
            <mat-option>
              <mat-checkbox [(ngModel)]="columnFilter.showBloodGroup" (click)="$event.stopPropagation();">Blood Group
              </mat-checkbox>
            </mat-option>
            <mat-option>
              <mat-checkbox [(ngModel)]="columnFilter.showFatherAnnualIncome" (click)="$event.stopPropagation();">
                Father's Annual Income
              </mat-checkbox>
            </mat-option>
            <mat-option>
              <mat-checkbox [(ngModel)]="columnFilter.showRTE" (click)="$event.stopPropagation();">
                RTE
              </mat-checkbox>
            </mat-option>
            <mat-option>
              <button class="btn"
                      style="padding: 4px 7px"
                      (click)="selectAllColumns(); $event.stopPropagation();">Select All
              </button>
              <button class="btn"
                      style="padding: 4px 7px"
                      (click)="unSelectAllColumns(); $event.stopPropagation();">Clear All
              </button>
            </mat-option>
          </mat-select>
        </mat-form-field>

        <button type="button"
                class="btn btn-{{user.btn_color}}"
                style="padding: 12px 15px; margin-right: 17px;"
                matTooltip="Print the following list"
                tooltip-position="left"
                (click)="printStudentList();">
          Print<i class="material-icons" style="margin-left: 15px;">print</i></button>

        <!-- Other Filters -->
        <mat-form-field style="float: right;">
          <mat-select placeholder="Filters">
            <mat-option>
              <mat-checkbox [(ngModel)]="scSelected"
                            style="margin-right: 5px;"
                            (ngModelChange)="handleStudentDisplay()"
                            (click)="$event.stopPropagation();">SC,
              </mat-checkbox>
              <mat-checkbox [(ngModel)]="stSelected"
                            style="margin-right: 5px;"
                            (ngModelChange)="handleStudentDisplay()"
                            (click)="$event.stopPropagation();">ST,
              </mat-checkbox>
              <mat-checkbox [(ngModel)]="obcSelected"
                            style="margin-right: 5px;"
                            (ngModelChange)="handleStudentDisplay()"
                            (click)="$event.stopPropagation();">OBC,
              </mat-checkbox>
              <mat-checkbox [(ngModel)]="generalSelected"
                            style="margin-right: 5px;"
                            (ngModelChange)="handleStudentDisplay()"
                            (click)="$event.stopPropagation();">Gen.
              </mat-checkbox>
            </mat-option>
            <mat-option>
              <mat-checkbox [(ngModel)]="maleSelected"
                            style="margin-right: 5px;"
                            (ngModelChange)="handleStudentDisplay()"
                            (click)="$event.stopPropagation();">M
              </mat-checkbox>
              <mat-checkbox [(ngModel)]="femaleSelected"
                            style="margin-right: 5px;"
                            (ngModelChange)="handleStudentDisplay()"
                            (click)="$event.stopPropagation();">F
              </mat-checkbox>
              <mat-checkbox [(ngModel)]="otherGenderSelected"
                            style="margin-right: 5px;"
                            (ngModelChange)="handleStudentDisplay()"
                            (click)="$event.stopPropagation();">Other
              </mat-checkbox>
            </mat-option>
          </mat-select>
        </mat-form-field>

        <br><i>Selected {{displayStudentNumber}} out of {{totalStudents}} students</i>

        <!-- Student Table List -->
        <ng-container *ngIf="!isLoading">
          <table class="table table-hover">
            <thead class="text-{{user.btn_color}}">
            <tr>
              <th [class.hidden]="!columnFilter.showSerialNumber">S No.</th>
              <th [class.hidden]="!columnFilter.showName">Name</th>
              <th [class.hidden]="!columnFilter.showClassName">Class Name</th>
              <th [class.hidden]="!columnFilter.showRollNumber">Roll No.</th>
              <th [class.hidden]="!columnFilter.showFathersName">Father's Name</th>
              <th [class.hidden]="!columnFilter.showMobileNumber">Mobile No.</th>
              <th [class.hidden]="!columnFilter.showScholarNumber">Scholar No.</th>
              <th [class.hidden]="!columnFilter.showDateOfBirth">Date of Birth</th>
              <th [class.hidden]="!columnFilter.showTotalFees">Total Fees</th>
              <th [class.hidden]="!columnFilter.showFeesDue">Fees Due</th>
              <th [class.hidden]="!columnFilter.showMotherName">Mother's Name</th>
              <th [class.hidden]="!columnFilter.showGender">Gender</th>
              <th [class.hidden]="!columnFilter.showCaste">Caste</th>
              <th [class.hidden]="!columnFilter.showCategory">Category</th>
              <th [class.hidden]="!columnFilter.showReligion">Religion</th>
              <th [class.hidden]="!columnFilter.showFatherOccupation">Father's Occupation</th>
              <th [class.hidden]="!columnFilter.showAddress">Address</th>
              <th [class.hidden]="!columnFilter.showChildSSMID">Child SSMID</th>
              <th [class.hidden]="!columnFilter.showFamilySSMID">Family SSMID</th>
              <th [class.hidden]="!columnFilter.showBankName">Bank Name</th>
              <th [class.hidden]="!columnFilter.showBankAccountNum">Bank Acc. No.</th>
              <th [class.hidden]="!columnFilter.showAadharNum">Aadhar No.</th>
              <th [class.hidden]="!columnFilter.showBloodGroup">Blood Group</th>
              <th [class.hidden]="!columnFilter.showFatherAnnualIncome">Father's Annual Income</th>
              <th [class.hidden]="!columnFilter.showRTE">RTE</th>
            </tr>
            </thead>
            <tbody>
            <ng-container *ngFor="let class of classSectionStudentList">
              <ng-container *ngFor="let section of class.sectionList">
                <tr *ngFor="let student of section.studentList;" [class.hidden]="!student.show">
                  <ng-container>
                    <td [class.hidden]="!columnFilter.showSerialNumber">{{student.serialNumber}}.</td>
                    <td [class.hidden]="!columnFilter.showName">{{student.name}}</td>
                    <td [class.hidden]="!columnFilter.showClassName">{{class.name}}<span
                        *ngIf="class.sectionList.length > 1">, {{section.name}}</span></td>
                    <td [class.hidden]="!columnFilter.showRollNumber">{{student.rollNumber}}</td>
                    <td [class.hidden]="!columnFilter.showFathersName">{{student.fathersName}}</td>
                    <td [class.hidden]="!columnFilter.showMobileNumber">{{student.mobileNumber}}</td>
                    <td [class.hidden]="!columnFilter.showScholarNumber">{{student.scholarNumber}}</td>
                    <td [class.hidden]="!columnFilter.showDateOfBirth">{{student.dateOfBirth | date: 'dd/MM/yyyy'}}</td>
                    <td [class.hidden]="!columnFilter.showTotalFees">{{student.totalFees}}</td>
                    <td [class.hidden]="!columnFilter.showFeesDue">{{student.feesDue}}</td>
                    <td [class.hidden]="!columnFilter.showMotherName">{{student.motherName}}</td>
                    <td [class.hidden]="!columnFilter.showGender">{{student.gender}}</td>
                    <td [class.hidden]="!columnFilter.showCaste">{{student.caste}}</td>
                    <td [class.hidden]="!columnFilter.showCategory">{{student.category}}</td>
                    <td [class.hidden]="!columnFilter.showReligion">{{student.religion}}</td>
                    <td [class.hidden]="!columnFilter.showFatherOccupation">{{student.fatherOccupation}}</td>
                    <td [class.hidden]="!columnFilter.showAddress">{{student.address}}</td>
                    <td [class.hidden]="!columnFilter.showChildSSMID">{{student.childSSMID}}</td>
                    <td [class.hidden]="!columnFilter.showFamilySSMID">{{student.familySSMID}}</td>
                    <td [class.hidden]="!columnFilter.showBankName">{{student.bankName}}</td>
                    <td [class.hidden]="!columnFilter.showBankAccountNum">{{student.bankAccountNum}}</td>
                    <td [class.hidden]="!columnFilter.showAadharNum">{{student.aadharNum}}</td>
                    <td [class.hidden]="!columnFilter.showBloodGroup">{{student.bloodGroup}}</td>
                    <td [class.hidden]="!columnFilter.showFatherAnnualIncome">{{student.fatherAnnualIncome}}</td>
                    <td [class.hidden]="!columnFilter.showRTE">{{student.rte}}</td>
                  </ng-container>
                </tr>
              </ng-container>
            </ng-container>
            </tbody>
          </table>
        </ng-container>

      </div>
    </div>

    <ng-container *ngIf="isLoading">
      <!-- div style="width: 100%; margin-top: 10mm;" align="center">
          <div class="loader"></div>
      </div -->
      <app-loading-spinner [user]="user"></app-loading-spinner>
    </ng-container>

  </div>
</div>
